!function(a,b){function c(a){return a?d(a):void 0}function d(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}function e(a){h&&(this.isIframe=j,this.options=a||{},this._emitter=new g,this.el=j?null:this.getFrame(this.options.id),this.prefix=new RegExp("^"+this.options.prefix),this.setOrigin(this.options.origin),this.addListener())}function f(a){a=a||{},this.current=a.hone,this.postEmitter=new e(a)}c.prototype.on=c.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},c.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},c.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},c.prototype.hasListeners=function(a){return!!this.listeners(a).length};var g,h="postMessage"in a&&"bind"in function(){}&&"JSON"in a,i="object"==typeof module&&"require"in a,j=top!==self;if(g=i?require("emitter"):c,e.prototype.getFrame=function(a){return b.getElementById(a)},e.prototype.on=function(){this._emitter.on.apply(this._emitter,arguments)},e.prototype.emit=function(){var b=Array.prototype.slice.call(arguments,0),c=this.serialize(b);return this.isIframe?(console.log(this._origin),a.parent.postMessage(c,this._origin)):void this.el.contentWindow.postMessage(c,this._origin)},e.prototype.setOrigin=function(a){return a?void(this._origin=a):void(this._origin="*")},e.prototype.onMessage=function(a){var b;b=this.deserialize(a.data),b&&Array.isArray(b)&&this._emitter.emit.apply(this._emitter,b)},e.prototype.deserialize=function(a){if(this.prefix.test(a)){var b=a.replace(this.prefix,"");try{b=JSON.parse(b)}catch(c){return this.emit("error",c)}return"object"==typeof b?b:void 0}},e.prototype.serialize=function(a){return this.options.prefix+JSON.stringify(a)},e.prototype.addListener=function(){a.addEventListener("message",this.onMessage.bind(this),!1)},e.inIframe=j,i&&(module.exports=e),"function"==typeof onPostEmitterReady)return onPostEmitterReady(e);f.prototype.onIframeResize=function(){var a=this.postEmitter.el;return function(b){"number"==typeof b.clientHeight&&(a.style.height=b.clientHeight+"px")}},f.prototype.on=function(){this.postEmitter.on.apply(this.postEmitter,arguments)},f.prototype.emit=function(){this.postEmitter.emit.apply(this.postEmitter,arguments)},f.urlParser=function(a){var b,c;if("string"==typeof a&&(a=a.split(/\//),b=a[a.length-2],c=a[a.length-1],b&&"contest"===b.toLowerCase()))return c=c.split(/\?/).shift(),{contestId:c,isContest:!0}};var k=b.querySelectorAll("hone-embed"),l=k.src,m=new f({id:"hone-embed",hone:f.urlParser(l)||{},prefix:"Hone:"});return"function"==typeof onHoneReady?onHoneReady(m):void(a.hone=m)}(window,document);